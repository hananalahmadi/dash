<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Disease mapping for hepatitis</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><img src="noname.png" alt="GeoHealth" style="height: 100px; width: 100px;"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Main</a>
</li>
<li>
  <a href="hepatities.html">Hepatities C</a>
</li>
<li>
  <a href="hepatitiesCB.html">Hepatities B &amp; Hepatities C</a>
</li>
<li>
  <a href="about.html">Methodology </a>
</li>
<li>
  <a href="Authors.html">Authors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Disease mapping for hepatitis</h1>

</div>


<p><br><br></p>
<div id="data-sources" class="section level1">
<h1>Data Sources</h1>
<p>Hepatitis B and C surveillance cases were obtained from the Saudi
Open Data Platform. Population denominators, essential for calculating
expected disease counts, were extracted from the Saudi Census Portal.
All data were aggregated at the administrative region level,
encompassing Saudi Arabiaâ€™s 13 regions. The temporal coverage varies by
disease: hepatitis C data spans from 2019 to 2022, while hepatitis B
data is available for 2019 only.</p>
</div>
<div id="spatial-temporal-disease-mapping" class="section level1">
<h1>Spatial temporal disease mapping</h1>
<p>The spatial temporal disease mapping model can be expressed as
follows:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
y_{ij} &amp;\sim Po(E_{ij}\theta_{ij}), \\
\log(\theta_{ij}) &amp;= \alpha + \sum_{f = 1}^{F} \beta_f X_{i f} +
(\beta + \Delta_i) \times t_j+ b_i
\end{split}
\label{diseasemappingtemporal}
\end{equation}\]</span> where <span
class="math inline">\(y_{ij}\)</span> is the number of the disease cases
observed at region <span class="math inline">\(i\)</span> and year <span
class="math inline">\(j\)</span>, <span
class="math inline">\(E_{ij}\)</span> is the expected count at region
<span class="math inline">\(i\)</span> and year <span
class="math inline">\(j\)</span>, <span
class="math inline">\(\theta_{ij}\)</span> is the relative risk of
region <span class="math inline">\(i\)</span> and year <span
class="math inline">\(j\)</span>, <span
class="math inline">\(\alpha\)</span> represents the overall risk level,
<span class="math inline">\(\beta_f\)</span> is the <span
class="math inline">\(f\)</span>-th fixed effect with covariate <span
class="math inline">\(\mathbf{X}_f\)</span>, <span
class="math inline">\(\beta\)</span> represent the fixed effect in time
that captures the global linear trend over time, <span
class="math inline">\(\Delta_i\)</span> follow independent and
identically normal distribution and it represent the interaction between
space and time, capturing how the area-specific trend deviates from the
global trend <span class="math inline">\(\beta\)</span>, <span
class="math inline">\(b_i\)</span> represents the spatial random effect
that follow BYM.</p>
</div>
<div id="joint-disease-mapping" class="section level1">
<h1>Joint disease mapping</h1>
<p>The joint disease mapping model based on an shared component model
(SCM) for two diseases can be expressed as follows for region <span
class="math inline">\(i\)</span>, <span class="math inline">\(i =
1,....,n\)</span>: <span class="math display">\[\begin{eqnarray}
y_{i 1}|\theta_{i1} &amp;\sim&amp; \text{Poisson}\left(E_{i 1} \theta_{i
1}\right) \nonumber \\
y_{i 2}|\theta_{i2} &amp;\sim&amp; \text{Poisson}\left(E_{i 2} \theta_{i
2}\right) \nonumber \\
\log (\theta_{i 1}) &amp;=&amp; \alpha_{1} + \sum_{f = 1}^{F_1} \beta_f
X_{i f} + b_{i 1} + S_{i} \nonumber \\
\log (\theta_{i 2}) &amp;=&amp; \alpha_{2} + \sum_{f = 1}^{F_2} \gamma_f
Z_{i f} + b_{i 2} + a S_{i}
\label{eq:jointmeanmodel}
\end{eqnarray}\]</span> where <span
class="math inline">\(y_{ij}\)</span> represents the number of cases of
disease <span class="math inline">\(j\)</span> in region <span
class="math inline">\(i\)</span>, <span
class="math inline">\(\theta_{ij}\)</span> is the relative risk of
disease <span class="math inline">\(j\)</span> in region <span
class="math inline">\(i\)</span>, and <span
class="math inline">\(E_{ij}\)</span> is the expected number of cases
for disease <span class="math inline">\(j\)</span> in region <span
class="math inline">\(i\)</span>. Additionally, <span
class="math inline">\(\alpha_j\)</span> is a disease-specific intercept
for disease <span class="math inline">\(j\)</span>, <span
class="math inline">\(\beta_f\)</span> is the <span
class="math inline">\(f\)</span>-th fixed effect for disease 1 with
covariate <span class="math inline">\(\mathbf{X}_f\)</span>, and <span
class="math inline">\(\gamma_f\)</span> is the <span
class="math inline">\(f\)</span>-th fixed effect for disease 2 with
covariate <span class="math inline">\(\mathbf{Z}_f\)</span>. The term
<span class="math inline">\(b_{ij}\)</span> represents a
disease-specific spatial random effect (modeled using the
Besag-York-MolliÃ© (BYM) model), while <span
class="math inline">\(S_i\)</span> is the shared spatial random effect
with a proper Besag prior, parameterized by <span
class="math inline">\(\tau\)</span> and <span
class="math inline">\(d\)</span>. <span
class="math display">\[\begin{equation}
        S_{i}|\mathbf{S}_{-i} \sim N\left(\bar{S}_{\delta_i},
\frac{\tau^{-1}}{(n_{\delta_i}+d)}\right), \forall i =1,\ldots, n,
        \label{eq:besagproper}
    \end{equation}\]</span> where <span class="math inline">\(d&gt;
0\)</span> for an non-intrinsic model, <span
class="math inline">\(\delta_i\)</span> represent the index set of
neighbors for area <span class="math inline">\(i\)</span>, and <span
class="math inline">\(n_{\delta_i}\)</span> denote the number of
neighbors for area <span class="math inline">\(i\)</span>. The term
<span class="math inline">\(\bar{S}_{\delta_i}\)</span> is defined as
the average of the neighboring values, given by <span
class="math inline">\(\bar{S}_{\delta_i} = \frac{1}{n_{\delta_i}}
\sum_{j \in \delta_i} S_j,\)</span> where <span
class="math inline">\(S_j\)</span> represents the values for neighboring
areas. Additionally, <span class="math inline">\(\tau\)</span> refers to
the precision parameter. Here, <span class="math inline">\(a\)</span>
and the shared component <span class="math inline">\(\mathbf{S}\)</span>
are used to evaluate the spatial dependence between the two diseases,
while the random effect <span
class="math inline">\(\mathbf{b}_j\)</span> captures the spatial effect
within each disease. The prior for <span
class="math inline">\(a\)</span> is assumed to be Gaussian, with mean 0
and variance 1.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
